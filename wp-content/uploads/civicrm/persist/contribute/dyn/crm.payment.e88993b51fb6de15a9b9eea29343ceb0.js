(function(t){var e={form:null,scriptName:'CRM.payment',getTotalAmount:function(){var e=0.0;if(CRM.payment.isEventAdditionalParticipants()){e=null}
else if(document.getElementById('totalTaxAmount')!==null){e=parseFloat(this.calculateTaxAmount());this.debugging(this.scriptName,'Calculated amount using internal calculateTaxAmount()')}
else if(typeof calculateTotalFee=='function'){e=parseFloat(calculateTotalFee())}
else if(this.getIsDrupalWebform()){t('.line-item:visible','#wf-crm-billing-items').each(function(){e+=parseFloat(t(this).data('amount'))})}
else if(document.getElementById('total_amount')){e=parseFloat(document.getElementById('total_amount').value)};this.debugging(this.scriptName,'getTotalAmount: '+e);return e},calculateTaxAmount:function(){var t=0;if(document.getElementById('totalTaxAmount')===null){return t};if(document.getElementById('totalTaxAmount').textContent.length===0){t=document.getElementById('total_amount').value}
else{t=document.getElementById('totalTaxAmount').textContent.split(' ').pop()};return t},getCurrency:function(t){var e=t;if(this.form.querySelector('#currency')){e=this.form.querySelector('#currency').value};this.debugging(this.scriptName,'Currency is: '+e);return e},isEventAdditionalParticipants:function(){if((document.getElementById('additional_participants')!==null)&&(document.getElementById('additional_participants').value.length!==0)){this.debugging(this.scriptName,'We don\'t know the final price - registering additional participants');return!0};return!1},getIsDrupalWebform:function(){if(this.form!==null){return this.form.classList.contains('webform-client-form')||this.form.classList.contains('webform-submission-form')};return!1},getBillingForm:function(){var e=t('div#card-element').closest('form').prop('id');if((typeof e==='undefined')||(!e.length)){e=t('input[name=hidden_processor]').closest('form').prop('id')};return document.getElementById(e)},getBillingSubmit:function(){var t=null;if(CRM.payment.getIsDrupalWebform()){t=this.form.querySelectorAll('[type="submit"].webform-submit');if(t.length===0){t=this.form.querySelectorAll('[type="submit"].webform-button--submit')}}
else{t=this.form.querySelectorAll('[type="submit"].validate')};if(t.length===0){this.debugging(this.scriptName,'No submit button found!')};return t},getIsRecur:function(){var e=!1;if(this.getIsDrupalWebform()){if((t('input[data-civicrm-field-key$="contribution_installments"]').length!==0&&t('input[data-civicrm-field-key$="contribution_installments"]').val()!=1)||(t('input[data-civicrm-field-key$="contribution_frequency_interval"]').length!==0&&t('input[data-civicrm-field-key$="contribution_frequency_interval"]').val()>0)){e=!0}};if(document.getElementById('is_recur')!==null){if(document.getElementById('is_recur').type=='hidden'){e=(document.getElementById('is_recur').value==1)}
else{e=Boolean(document.getElementById('is_recur').checked)}}
else if(t('input[name="auto_renew"]').length!==0){if(t('input[name="auto_renew"]').prop('checked')){e=!0}
else if(t('input[name="auto_renew"]').attr('type')=='hidden'){e=!0}
else{e=Boolean(t('input[name="auto_renew"]').checked)}};this.debugging(this.scriptName,'isRecur is '+e);return e},supportsRecur:function(){var e=!1;if(this.getIsDrupalWebform()){if((t('input[data-civicrm-field-key$="contribution_installments"]').length!==0)||(t('input[data-civicrm-field-key$="contribution_frequency_interval"]').length!==0)){e=!0}};if(document.getElementById('is_recur')!==null){e=!0}
else if(t('input[name="auto_renew"]').length!==0){e=!0};this.debugging(this.scriptName,'supportsRecur is '+e);return e},getBillingEmail:function(){var e='';t(this.form).find('input.email').each(function(){e+=t(this).val()+';'});return e},getBillingName:function(){var e='';t(this.form).find('input#first_name,input#last_name').each(function(){e+=t(this).val()+';'});return e},getPaymentProcessorSelectorValue:function(){var t=this.form.querySelector('input[name="payment_processor_id"]:checked');if(t!==null){return parseInt(t.value)}
else{t=this.form.querySelector('select[name="payment_processor_id"]');if(t!==null){return parseInt(t.value)}};return null},isAJAXPaymentForm:function(t){return(t.match('civicrm(\/|%2F)payment(\/|%2F)form')!==null)||(t.match('civicrm(\/|\%2F)contact(\/|\%2F)view(\/|\%2F)participant')!==null)||(t.match('civicrm(\/|\%2F)contact(\/|\%2F)view(\/|\%2F)membership')!==null)||(t.match('civicrm(\/|\%2F)contact(\/|\%2F)view(\/|\%2F)contribution')!==null)},debugging:function(t,e){if((typeof(CRM.vars.stripe)==='undefined')||(Boolean(CRM.vars.stripe.jsDebug)===!0)){console.log(new Date().toISOString()+' '+t+': '+e)}}};if(typeof CRM.payment==='undefined'){CRM.payment=e}
else{if(CRM.payment.hasOwnProperty('scriptName')&&(CRM.payment.scriptName==='CRM.payment')){return};if(CRM.payment.hasOwnProperty('getTotalAmount')){delete(e.getTotalAmount);e.debugging(e.scriptName,'Deferring to client getTotalAmount function')};t.extend(CRM.payment,e)};document.addEventListener('DOMContentLoaded',function(){CRM.payment.debugging(CRM.payment.scriptName,'loaded via DOMContentLoaded');CRM.payment.form=CRM.payment.getBillingForm()});t(document).ajaxComplete(function(t,e,n){if(CRM.payment.isAJAXPaymentForm(n.url)){CRM.payment.debugging(CRM.payment.scriptName,'triggered via ajax');CRM.payment.form=CRM.payment.getBillingForm()}})}(CRM.$));